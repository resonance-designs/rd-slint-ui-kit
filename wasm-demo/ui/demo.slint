import { ScrollView } from "std-widgets.slint";
import { Theme, ThemeManager } from "../../theme/index.slint";
import { 
    RDSButton, 
    RDSSelectButton, 
    RDSKnob, 
    RDSSlider, 
    RDSToggle, 
    RDSCircleToggle,
    RDSHeaderLabel,
    RDSVUMeter,
    RDSVertVUMeter,
    RDSWaveformViz,
    RDSOscilloscopeViz,
    RDSSpectrumViz,
    RDSVectorscopeViz,
    RDSSequencerCell,
    RDSComboBox,
    RDSNumStepper,
    RDSXYPad,
    RDSNumericKeypad,
    RDSKeybed
} from "../../components/index.slint";

export component DemoWindow inherits Window {
    title: "RDS UI Kit Demo";
    width: 1000px;
    height: 800px;
    background: Theme.active.background_main;

    ScrollView {
        width: 100%;
        height: 100%;
        
        VerticalLayout {
            padding: 20px;
            spacing: 20px;

            // --- Top Header with Theme Toggle ---
            HorizontalLayout {
                height: 40px;
                spacing: 10px;
                
                RDSHeaderLabel {
                    text: "RDS Slint UI Kit - Wasm Demo";
                    horizontal-alignment: left;
                    padding-horizontal: 15px;
                }
                
                RDSToggle {
                    width: 120px;
                    height: 30px;
                    on-icon: "light_mode";
                    off-icon: "dark_mode";
                    active: Theme.active.background_main == #ffffff;
                    clicked => {
                        if (self.active) {
                            ThemeManager.switch_to_dark();
                        } else {
                            ThemeManager.switch_to_light();
                        }
                    }
                }
            }

            HorizontalLayout {
                spacing: 20px;

                // --- Column 1: Buttons & Selectors ---
                VerticalLayout {
                    spacing: 15px;
                    width: 220px;

                    RDSHeaderLabel { text: "Buttons"; }

                    HorizontalLayout {
                        spacing: 10px;
                        RDSButton { label: "Standard"; }
                        RDSButton { label: "Active"; active: true; }
                    }

                    RDSSelectButton {
                        label: "Toggle Select";
                        clicked => { self.active = !self.active; }
                    }

                    RDSHeaderLabel { text: "Selectors"; }
                    
                    RDSComboBox {
                        model: ["Option 1", "Option 2", "Option 3"];
                        current-index: 0;
                    }

                    RDSNumStepper {
                        value: 120;
                        min-value: 20;
                        max-value: 300;
                    }

                    HorizontalLayout {
                        spacing: 8px;
                        for i in 4: RDSSequencerCell {
                            active: i == 0 || i == 2;
                            clicked => { self.active = !self.active; }
                        }
                    }
                }

                // --- Column 2: Continuous Controls ---
                VerticalLayout {
                    spacing: 15px;
                    width: 280px;

                    RDSHeaderLabel { text: "Controls"; }

                    HorizontalLayout {
                        spacing: 20px;

                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "Gain"; color: Theme.active.text_secondary; font-size: 11px; horizontal-alignment: center; }
                            RDSKnob {
                                value: 65;
                                size: 60px;
                            }
                        }

                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "Fader"; color: Theme.active.text_secondary; font-size: 11px; horizontal-alignment: center; }
                            RDSSlider {
                                value: 90;
                                height-override: 160px;
                            }
                        }
                    }

                    HorizontalLayout {
                        spacing: 15px;
                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "Master FX"; color: Theme.active.text_secondary; font-size: 11px; }
                            RDSToggle {
                                active: true;
                                clicked => { self.active = !self.active; }
                            }
                        }
                        VerticalLayout {
                            spacing: 4px;
                            Text { text: "Power"; color: Theme.active.text_secondary; font-size: 11px; }
                            RDSCircleToggle {
                                active: true;
                                clicked => { self.active = !self.active; }
                            }
                        }
                    }
                }

                // --- Column 3: Viz & Pads ---
                VerticalLayout {
                    spacing: 15px;
                    width: 380px;

                    RDSHeaderLabel { text: "Visuals"; }

                    HorizontalLayout {
                        spacing: 15px;
                        RDSVUMeter {
                            level: 0.7;
                            width: 140px;
                        }
                        RDSVertVUMeter {
                            level: 0.5;
                        }
                    }

                    RDSWaveformViz {
                        waveform: [0.1, 0.4, 0.2, 0.8, 0.5, 0.3, 0.7, 0.2, 0.4, 0.1];
                        height: 50px;
                    }

                    HorizontalLayout {
                        spacing: 8px;
                        RDSOscilloscopeViz {
                            oscilloscope: [0.1, 0.5, -0.3, 0.8, -0.2, 0.4, -0.6, 0.3];
                            height: 50px;
                            width: 90px;
                        }
                        RDSSpectrumViz {
                            spectrum: [0.2, 0.4, 0.8, 0.6, 0.3, 0.5, 0.9, 0.4];
                            height: 50px;
                            width: 90px;
                        }
                        RDSVectorscopeViz {
                            vectorscope_x: [0.1, 0.5, 0.8, 0.2, -0.3, -0.7];
                            vectorscope_y: [0.2, 0.6, 0.3, -0.1, -0.5, -0.2];
                            height: 50px;
                            width: 50px;
                        }
                    }

                    VerticalLayout {
                        spacing: 4px;
                        Text { text: "Filter XY"; color: Theme.active.text_secondary; font-size: 11px; }
                        RDSXYPad {
                            width: 160px;
                            height: 160px;
                        }
                    }
                }
            }

            // --- Row 2: Large Inputs ---
            HorizontalLayout {
                spacing: 20px;
                VerticalLayout {
                    spacing: 8px;
                    RDSHeaderLabel { text: "Keypad"; }
                    RDSNumericKeypad {
                        current-value: 440.0;
                    }
                }
                VerticalLayout {
                    spacing: 8px;
                    RDSHeaderLabel { text: "Keybed"; }
                    RDSKeybed {
                        octaves: 2;
                        width: 500px;
                    }
                }
            }
        }
    }
}
